###  ä¸€.åŒå‘æ•°æ®ç»‘å®šåˆæ­¥ç†è§£



å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„å•å‘ç»‘å®š    

```html
<body>
<div id="root">
    <div>Hello Vue!</div>
    <p>{{content}}</p>
</div>

<script>
    new Vue({
        el:'#root',
        data: {
            content:"one-way binding"
        }
    })
</script>
</body>
```

 <img src="åŸºæœ¬æ¦‚å¿µ.assets/image-20210322212013021.png" alt="image-20210322212013021" style="zoom:67%;" />

â–¼åœ¨è¿™é‡Œé€šè¿‡Vueå®ä¾‹ä¸­dataçš„contentä¼ é€’ç»™äº†htmlçš„pæ ‡ç­¾,  ä½†æ˜¯æ— æ³•é€šè¿‡pæ ‡ç­¾å»æ”¹å˜content

<span style="font-weight:bold; color:red;">ğŸŒŸæ•°æ®å†³å®šé¡µé¢çš„æ˜¾ç¤º, ä½†æ˜¯é¡µé¢æ— æ³•å†³å®šæ•°æ®çš„å†…å®¹!</span>



ä¸Šé¢çš„æ— æ³•å†³å®šä½ å¯èƒ½ä¼šè§‰å¾—æ˜¯å› ä¸ºæ ¹æœ¬æ— æ³•æ”¹å˜pæ ‡ç­¾, é‚£ä¹ˆæ¥ä¸‹æ¥æ¢æˆ input



```html
<body>
<div id="root">
    <div>Hello Vue!</div>
    <input :value="content" />
    <p>{{content}}</p>
</div>

<script>
    new Vue({
        el:'#root',
        data: {
            content:"one-way binding"
        }
    })
</script>
</body>
```

 <img src="åŸºæœ¬æ¦‚å¿µ.assets/image-20210322212424385.png" alt="image-20210322212424385" style="zoom:67%;" />



å¯ä»¥å‘ç°æˆ‘ä»¬ä¿®æ”¹inputä¸­çš„valueå€¼, å¯æ˜¯ä¸‹é¢å¯¹åº”çš„pæ ‡ç­¾çš„contentå¹¶æ²¡æœ‰å˜åŒ–!!!

**ğŸŒŸè¯´æ˜è¿™è¿˜æ˜¯å•å‘ç»‘å®š**



ä½†æ˜¯ <span style="font-weight:bold; color:red;">v-model</span> å´å¯ä»¥å®ç°åŒå‘ç»‘å®š  

```html
<body>
<div id="root">
    <div>Hello Vue!</div>
    <input v-model="content" />
    <p>{{content}}</p>
</div>

<script>
    new Vue({
        el:'#root',
        data: {
            content:"one-way binding"
        }
    })
</script>
</body>
```

 <img src="åŸºæœ¬æ¦‚å¿µ.assets/image-20210322212559306.png" alt="image-20210322212559306" style="zoom:67%;" />

ğŸŒŸå¯ä»¥å‘ç°, ä¸‹é¢çš„contentè·Ÿéšinputè¾“å…¥çš„valueä¸€èµ·å˜åŒ–!





### äºŒ.Vueç”Ÿå‘½å‘¨æœŸ



![img](åŸºç¡€.assets/16ca74f183827f46)



#### Vueç”Ÿå‘½å‘¨æœŸä¸­çš„hookå‡½æ•°

- **beforeCreate**
- **created**
- **beforeMount**
- **mounted**
- **beforeUpdate**
- **updated**
- **beforeDestroy**
- **destroyed**

**ğŸŒŸå…¶å®å°±æ˜¯Create , Mount , Update , Destroy**



ç¤ºä¾‹

HTML

```html
<div id="app">
    <h1>{{message}}</h1>
</div>
```

 js

```js
<script>
    var vm = new Vue({
        // el: '#app',
        data: {
            message: 'Vueçš„ç”Ÿå‘½å‘¨æœŸ'
        },
        template:`<div>template</div>`,

        beforeCreate: function() {
            console.group('------beforeCreateåˆ›å»ºå‰çŠ¶æ€------');
            console.log("%c%s", "color:red" , "el     : " + this.$el); //undefined
            console.log("%c%s", "color:red","data   : " + this.$data); //undefined
            console.log("%c%s", "color:red","message: " + this.message)
        },
        created: function() {
            console.group('------createdåˆ›å»ºå®Œæ¯•çŠ¶æ€------');
            console.log("%c%s", "color:red","el     : " + this.$el); //undefined
            console.log("%c%s", "color:red","data   : " + this.$data); //å·²è¢«åˆå§‹åŒ–
            console.log("%c%s", "color:red","message: " + this.message); //å·²è¢«åˆå§‹åŒ–
        },
        beforeMount: function() {
            console.group('------beforeMountæŒ‚è½½å‰çŠ¶æ€------');
            console.log("%c%s", "color:red","el     : " + (this.$el)); //å·²è¢«åˆå§‹åŒ–
            console.log(this.$el);
            console.log("%c%s", "color:red","data   : " + this.$data); //å·²è¢«åˆå§‹åŒ–
            console.log("%c%s", "color:red","message: " + this.message); //å·²è¢«åˆå§‹åŒ–
        },
        mounted: function() {
            console.group('------mounted æŒ‚è½½ç»“æŸçŠ¶æ€------');
            console.log("%c%s", "color:red","el     : " + this.$el); //å·²è¢«åˆå§‹åŒ–
            console.log(this.$el);
            console.log("%c%s", "color:red","data   : " + this.$data); //å·²è¢«åˆå§‹åŒ–
            console.log("%c%s", "color:red","message: " + this.message); //å·²è¢«åˆå§‹åŒ–
        },
        beforeUpdate: function () {
            console.group('beforeUpdate æ›´æ–°å‰çŠ¶æ€===============ã€‹');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);
            console.log("%c%s", "color:red","data   : " + this.$data);
            console.log("%c%s", "color:red","message: " + this.message);
        },
        updated: function () {
            console.group('updated æ›´æ–°å®ŒæˆçŠ¶æ€===============ã€‹');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);
            console.log("%c%s", "color:red","data   : " + this.$data);
            console.log("%c%s", "color:red","message: " + this.message);
        },
        beforeDestroy: function () {
            console.group('beforeDestroy é”€æ¯å‰çŠ¶æ€===============ã€‹');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);
            console.log("%c%s", "color:red","data   : " + this.$data);
            console.log("%c%s", "color:red","message: " + this.message);
        },
        destroyed: function () {
            console.group('destroyed é”€æ¯å®ŒæˆçŠ¶æ€===============ã€‹');
            console.log("%c%s", "color:red","el     : " + this.$el);
            console.log(this.$el);
            console.log("%c%s", "color:red","data   : " + this.$data);
            console.log("%c%s", "color:red","message: " + this.message)
        }
    })
</script>
```

â–¼è¿™æ˜¯åœ¨æ‰§è¡Œè‡ªå®šä¹‰é’©å­å‡½æ•°åçš„æ‰“å°ç»“æœ:

 <img src="åŸºç¡€.assets/image-20210323142141109.png" alt="image-20210323142141109" style="zoom:67%;" />



##### **1. åœ¨beforeCreateå’Œcreatedé’©å­å‡½æ•°ä¹‹é—´çš„ç”Ÿå‘½å‘¨æœŸ**

åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¹‹é—´ï¼Œ**è¿›è¡Œæ•°æ®çš„è§‚æµ‹, å¹¶åˆå§‹åŒ–äº‹ä»¶**,  è€Œåœ¨**created**çš„æ—¶å€™æ•°æ®å·²ç»å’Œ**dataå±æ€§è¿›è¡Œç»‘å®š**, ä½†æ˜¯$elä»æœªè¢«åˆå§‹åŒ–ã€‚

createdï¼š**åœ¨è¿™ä¸€æ­¥ï¼Œå®ä¾‹å·²å®Œæˆä»¥ä¸‹é…ç½®ï¼šæ•°æ®è§‚æµ‹ã€å±æ€§å’Œæ–¹æ³•çš„è¿ç®—ï¼Œwatch/eventäº‹ä»¶å›è°ƒï¼Œå®Œæˆäº†data æ•°æ®çš„åˆå§‹åŒ–ï¼Œelæ²¡æœ‰ã€‚**



##### **2. createdé’©å­å‡½æ•°å’ŒbeforeMounté—´çš„ç”Ÿå‘½å‘¨æœŸ**

 ![clipboard.png](åŸºç¡€.assets/bVVUb9)

â–¼åœ¨è¿™é‡Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨elå±æ€§ï¼Ÿï¼ˆå¯ä»¥è”æƒ³åˆ°ä¹‹å‰è®²åˆ°çš„ç»„ä»¶ä¹Ÿæ˜¯Vueå®ä¾‹ï¼ï¼‰

if æ²¡æœ‰ elï¼šï¼ˆæ³¨é‡Šæ‰Vueå®ä¾‹ä¸­çš„ elå±æ€§ï¼‰

 **ç„¶åè¿è¡Œå¯ä»¥çœ‹åˆ°åˆ°createdçš„æ—¶å€™å°±åœæ­¢äº†!**  å› ä¸ºæ²¡æœ‰elæ— æ³•è¿›è¡Œmountâ—

 <img src="åŸºç¡€.assets/image-20210323144158824.png" alt="image-20210323144158824" style="zoom:60%;" />

**ä½†æ˜¯å¦‚æœæˆ‘ä»¬ç°åœ¨è°ƒç”¨mountå‡½æ•°**ï¼š  vm.$mount(document.getElementById("app"))
**å°±ä¼šè¿›å…¥mountçŠ¶æ€ï¼ŒåŒæ—¶messageä¹Ÿä¼šç›¸åº”åœ°å˜åŒ–**



 <img src="åŸºç¡€.assets/image-20210323144514511.png" alt="image-20210323144514511" style="zoom:50%;" />



â–¼ç„¶åï¼Œæˆ‘ä»¬å¾€ä¸‹çœ‹ï¼Œ**template**å‚æ•°é€‰é¡¹çš„æœ‰æ— å¯¹ç”Ÿå‘½å‘¨æœŸçš„å½±å“ã€‚ï¼ˆè”ç³»ç»„ä»¶ï¼‰

ï¼ˆ1ï¼‰å¦‚æœvueå®ä¾‹å¯¹è±¡ä¸­æœ‰templateå‚æ•°é€‰é¡¹ï¼Œåˆ™å°†å…¶ä½œä¸ºæ¨¡æ¿ç¼–è¯‘æˆrenderå‡½æ•°ã€‚
ï¼ˆ2ï¼‰å¦‚æœæ²¡æœ‰templateé€‰é¡¹ï¼Œåˆ™å°†å¤–éƒ¨HTMLä½œä¸ºæ¨¡æ¿ç¼–è¯‘ã€‚
ï¼ˆ3ï¼‰å¯ä»¥çœ‹åˆ°**templateä¸­çš„æ¨¡æ¿ä¼˜å…ˆçº§è¦é«˜äºouter HTMLçš„ä¼˜å…ˆçº§ã€‚**



æ­¤æ—¶æˆ‘ä»¬åœ¨Vueå®ä¾‹ä¸­æ·»åŠ template

```js
template: "<h1>{{message +'è¿™æ˜¯åœ¨templateä¸­çš„'}}</h1>", //åœ¨vueé…ç½®é¡¹ä¸­ä¿®æ”¹çš„
```

å°±å¯ä»¥åœ¨çœ‹åˆ°åœ¨é¡µé¢ä¸­çš„æ˜¾ç¤ºï¼š

 <img src="åŸºç¡€.assets/image-20210323145043061.png" alt="image-20210323145043061" style="zoom: 50%;" />



Vueè¦é€šè¿‡elå¾—åˆ°å¯¹åº”çš„outHTMLä½œä¸ºtemplateï¼ˆå¦‚æœå†…ç½®äº†templateåˆ™é‡‡ç”¨å†…ç½®çš„ï¼‰ï¼Œåæ­£è¦å…ˆåˆ¤æ–­el



plusï¼š

åœ¨vueå¯¹è±¡ä¸­è¿˜æœ‰ä¸€ä¸ª**renderå‡½æ•°**ï¼Œå®ƒæ˜¯ä»¥createElementä½œä¸ºå‚æ•°ï¼Œç„¶ååšæ¸²æŸ“æ“ä½œï¼Œè€Œä¸”æˆ‘ä»¬å¯ä»¥ç›´æ¥åµŒå…¥JSX.

```js
new Vue({
    el: '#app',
    render: function(createElement) {
        return createElement('h1', 'this is createElement')
    }
})
```

å¯ä»¥çœ‹åˆ°é¡µé¢ä¸­æ¸²æŸ“çš„æ˜¯ï¼š

![clipboard.png](åŸºç¡€.assets/bVVUSo)

æ‰€ä»¥ç»¼åˆæ’åä¼˜å…ˆçº§ï¼š

<span style="font-weight:bold; color:red;">ğŸš©renderå‡½æ•°é€‰é¡¹ > templateé€‰é¡¹ > outer HTML.</span>



##### **3. beforeMountå’Œmounted é’©å­å‡½æ•°é—´çš„ç”Ÿå‘½å‘¨æœŸ**

 <img src="åŸºç¡€.assets/bVVUTK" alt="clipboard.png" style="zoom:110%;" />

å¯ä»¥çœ‹åˆ°æ­¤æ—¶æ˜¯ç»™vueå®ä¾‹å¯¹è±¡æ·»åŠ **$elæˆå‘˜**ï¼Œå¹¶ä¸”æ›¿æ¢æ‰æŒ‚è½½çš„DOMå…ƒç´ ã€‚å› ä¸ºåœ¨ä¹‹å‰consoleä¸­æ‰“å°çš„ç»“æœå¯ä»¥çœ‹åˆ°**beforeMount**ä¹‹å‰elä¸Šè¿˜æ˜¯undefinedã€‚  

â—ä¸è¿‡æˆ‘çœ‹æºç , åœ¨beforeMountæ—¶ $elåº”è¯¥è¿˜æ˜¯undefined, åœ¨mountedçš„æ—¶å€™æ‰è¢«èµ‹å€¼æŒ‚è½½

â—consoleæ‰“å°å‡ºæ¥çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶å€™å½“ç„¶æ²¡é—®é¢˜ï¼Œå¦åˆ™å¯¹äºå¤æ‚æ•°æ®ç±»å‹æ˜¯ä¼šå‘ç”Ÿæ”¹å˜çš„ï¼Œå› ä¸ºåªæ˜¯åœ°å€å¼•ç”¨è€Œå·²

  <img src="åŸºç¡€.assets/image-20210323150656467.png" alt="image-20210323150656467" style="zoom:60%;" />



##### **4. mounted**

æ³¨æ„çœ‹ä¸‹é¢æˆªå›¾ï¼š

 ![clipboard.png](åŸºç¡€.assets/bVVUYC)

â–¼åœ¨mountedä¹‹å‰h1ä¸­è¿˜æ˜¯é€šè¿‡**{{message}}**è¿›è¡Œå ä½çš„ï¼Œå› ä¸ºæ­¤æ—¶è¿˜æ²¡æœ‰æŒ‚è½½åˆ°é¡µé¢ä¸Šï¼Œè¿˜æ˜¯JavaScriptä¸­çš„è™šæ‹ŸDOMå½¢å¼å­˜åœ¨çš„ã€‚åœ¨mountedä¹‹åå¯ä»¥çœ‹åˆ°h1ä¸­çš„å†…å®¹å‘ç”Ÿäº†å˜åŒ–ã€‚





##### **5. beforeUpdateé’©å­å‡½æ•°å’Œupdatedé’©å­å‡½æ•°é—´çš„ç”Ÿå‘½å‘¨æœŸ**

 ![clipboard.png](åŸºç¡€.assets/bVVU0E)

å½“vueå‘ç°dataä¸­çš„æ•°æ®å‘ç”Ÿäº†æ”¹å˜ï¼Œä¼š**è§¦å‘å¯¹åº”ç»„ä»¶çš„é‡æ–°æ¸²æŸ“**ï¼Œå…ˆåè°ƒç”¨**beforeUpdate**å’Œ**updated**é’©å­å‡½æ•°ã€‚æˆ‘ä»¬åœ¨consoleä¸­è¾“å…¥ï¼š

```js
vm.message = 'è§¦å‘ç»„ä»¶æ›´æ–°'
```

å°±ä¼šè§¦å‘ç»„ä»¶æ›´æ–°

 <img src="åŸºç¡€.assets/image-20210323150851739.png" alt="image-20210323150851739" style="zoom:50%;" />

  <img src="åŸºç¡€.assets/image-20210323151004992.png" alt="image-20210323151004992" style="zoom: 67%;" />

ğŸŒŸè¿™é‡Œå¯ä»¥å‘ç°beforeUpdateæ—¶elä¸­çš„dataå·²ç»å˜åŒ–ï¼Œä½†è¿™æ—¶å¹¶ä¸ä¼šæ›´æ–°é¡µé¢ã€‚å› ä¸ºbeforeUpdateåˆ°updatedè¿™ä¸ªè¿‡ç¨‹æ‰æ˜¯æ¸²æŸ“æ›´æ–°é¡µé¢çš„è¿‡ç¨‹ï¼Œupdatedæ—¶é¡µé¢æ‰è¢«é‡æ–°æ¸²æŸ“å®Œæˆã€‚



<span style="font-size:20px;font-weight:bold">â˜…åœ¨beforeUpdate,å¯ä»¥ç›‘å¬åˆ°dataçš„å˜åŒ–ä½†æ˜¯viewå±‚æ²¡æœ‰è¢«é‡æ–°æ¸²æŸ“ï¼Œviewå±‚çš„æ•°æ®æ²¡æœ‰å˜åŒ–ã€‚ç­‰åˆ°updatedçš„æ—¶å€™ viewå±‚æ‰è¢«é‡æ–°æ¸²æŸ“ï¼Œæ•°æ®æ›´æ–°ã€‚ </span>



å¦‚æœæˆ‘ä»¬åœ¨beforeUpdateçš„å‡½æ•°ä¸­æ·»åŠ   console.log(this.$el.innerHTML); 
å°±ä¼šå‘ç°æ‰“å°å‡ºæ¥çš„htmlè§†å›¾ä¸­çš„æ•°æ®å¹¶æ²¡æœ‰å˜åŒ–

 <img src="åŸºç¡€.assets/image-20210323152406554.png" alt="image-20210323152406554" style="zoom:67%;" />





##### **6.beforeDestroyå’Œdestroyedé’©å­å‡½æ•°é—´çš„ç”Ÿå‘½å‘¨æœŸ**

 ![clipboard.png](åŸºç¡€.assets/bVVU6C)

 <img src="åŸºç¡€.assets/image-20210323151619360.png" alt="image-20210323151619360" style="zoom:67%;" /> 

**beforeDestroy**é’©å­å‡½æ•°åœ¨å®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚**åœ¨è¿™ä¸€æ­¥ï¼Œå®ä¾‹ä»ç„¶å®Œå…¨å¯ç”¨**ã€‚
**destroyed**é’©å­å‡½æ•°åœ¨Vue å®ä¾‹é”€æ¯åè°ƒç”¨ã€‚è°ƒç”¨åï¼ŒVue å®ä¾‹æŒ‡ç¤ºçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè§£ç»‘å®šï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ä¹Ÿä¼šè¢«é”€æ¯ã€‚

![img](åŸºç¡€.assets/16ca74f183827f46)

 



### ä¸‰. ä½¿ç”¨æ•°ç»„ä¸‹æ ‡æ”¹å˜å€¼ä¸ºä»€ä¹ˆä¸ä¼šè§¦å‘å“åº”å¼ï¼Ÿ



â€‹	ğŸŒŸä¸€å¥è¯æ¦‚æ‹¬ï¼šåœ¨å¯¹æ•°ç»„è¿›è¡Œç›‘å¬æ—¶ä¼šé‡‡ç”¨ç‰¹æ®Šçš„ç›‘å¬æ–¹æ³•, å¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„è¯, ä¼šé€šè¿‡å¯¹æŒ‡å®šçš„æ•°ç»„çš„ä¸ƒä¸ªæ–¹æ³•è¿›è¡Œå°è£…(augment)åç›‘å¬; å¦‚æœæ˜¯å¯¹è±¡ä¼šå†æ¬¡è°ƒç”¨observeå‡½æ•°è¿›è¡Œç›‘å¬ã€‚

1. **observe(value) æ–¹æ³•å¯¹objectå’ŒArrayåˆ›å»ºä¸€ä¸ªç›‘å¬å™¨new Observer()value**   (åŸºæœ¬ç±»å‹ä¼šç›´æ¥return)
2. **Observerä¸­å¯¹æ•°ç»„è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå¹¶è°ƒç”¨observeArray()**
3. **observeArrayä¸­å†æ¬¡éå†å¹¶å¯¹æ•°ç»„å…ƒç´ è¿›è¡Œobserve, ç„¶åå›åˆ°1**



â€‹	å‚è€ƒ: https://blog.csdn.net/qq_46299172/article/details/108509814

â€‹	â–¼Vue ä¸èƒ½æ£€æµ‹ä»¥ä¸‹æ•°ç»„çš„å˜åŠ¨ï¼š  [å®˜æ–¹æ–‡æ¡£](https://vuejs.bootcss.com/guide/reactivity.html#%E5%AF%B9%E4%BA%8E%E6%95%B0%E7%BB%84)

1. å½“ä½ åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªæ•°ç»„é¡¹æ—¶ï¼Œä¾‹å¦‚ï¼š`vm.items[indexOfItem] = newValue`
2. å½“ä½ ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ï¼š`vm.items.length = newLength`

â€‹	â—**ä¸è¿‡å¯¹äºæ•°ç»„ä¸­çš„å¯¹è±¡ä¾ç„¶æ˜¯å“åº”å¼çš„!!!** å¹¶ä¸”æ›´æ”¹æ•°ç»„ä¸­çš„å¯¹è±¡æ—¶ä¼šè§¦å‘æ•´ä¸ªæ•°ç»„ä¸€èµ·çš„å“åº”å¼æ›´æ–°!!!

```html
<div id="app">
    <ul>
        <li v-for="item in list">
            {{item}}
        </li>
    </ul>
</div>
```

```html
<script>
    const app=new Vue({
        el:'#app',
        data:{
            list:['4','5','6',{'1':1,'2':2}]
        },
        mounted(){
            this.list[1]='1';
            this.list[3]["1"]=3;
        }
    })
</script>
```

â–¼å¦‚æœä¸æ›´æ–°æ•°ç»„ä¸­çš„å¯¹è±¡, åªæœ‰   this.list[1]='1'; çš„è¯æ˜¯ä¸ä¼šå†è§†å›¾ä¸Šè¿›è¡Œæ›´æ–°çš„!! ä½†æ˜¯dataä¸­çš„listç¡®å®æ”¹å˜äº†

â–¼å¦‚æœæ›´æ–°æ•°ç»„ä¸­çš„å¯¹è±¡, åŠ ä¸Š this.list[3] ["1"] =3;  ä¼šè¿å¸¦æŠŠæ•´ä¸ªæ•°ç»„éƒ½åœ¨è§†å›¾ä¸Šæ›´æ–°



**é¦–å…ˆåˆ†ææºç :**

ä» **initData** ä¸­ä¼šæ‰§è¡Œ **observe** å‡½æ•°

#### observe

```js
/**
 * Attempt to create an observer instance for a value,
 * returns the new observer if successfully observed,
 * or the existing observer if the value already has one.
 */
function observe (value, asRootData) {
  //åˆ¤æ–­æ˜¯å¦ä¸ºå¯¹è±¡,æˆ–è€…æ˜¯å¦ä¸ºVNodeçš„å®ä¾‹  
  if (!isObject(value) || value instanceof VNode) {
    //å¦‚æœvalueä¸æ˜¯å¯¹è±¡æˆ–è€…valueä½¿VNodeçš„å®ä¾‹ç›´æ¥return
    return
  }
    
  // è§‚å¯Ÿè€… åˆ›å»ºä¸€ä¸ªob
  var ob;
  if (hasOwn(value, '__ob__') && value.__ob__ instanceof Observer) {
    //æ£€æµ‹valueæ˜¯å¦æœ‰valueçš„__ob__ç¼“å­˜,å¦‚æœæœ‰åˆ™ç›´æ¥è·å–
    ob = value.__ob__;
  } else if (
    shouldObserve &&   //  å½“å‰çŠ¶æ€æ˜¯å¦èƒ½æ·»åŠ è§‚å¯Ÿè€…
    !isServerRendering() &&
    (Array.isArray(value) || isPlainObject(value)) &&  //â˜…æ˜¯å¦ä¸ºå¯¹è±¡æˆ–è€…æ•°ç»„
    Object.isExtensible(value) &&    // æ˜¯å¦å¯ä»¥åœ¨å®ƒä¸Šé¢æ·»åŠ æ–°çš„å±æ€§
    !value._isVue
  ) {
    //å¦‚æœæ»¡è¶³ä¸Šè¿°æ¡ä»¶, åˆ™newä¸€ä¸ªObserverå®ä¾‹å¯¹valueè¿›è¡Œç›‘å¬,å³æŠŠvalueå“åº”åŒ– 
    ob = new Observer(value);
  }
  if (asRootData && ob) {
    ob.vmCount++;
  }
  return ob
}
```

â˜…observeå‡½æ•°ä¸»è¦çš„ä½œç”¨å°±æ˜¯åˆ¤æ–­valueæ˜¯å¦ä¸ºå¯¹è±¡oræ•°ç»„,  æ»¡è¶³æ¡ä»¶åˆ™new Observer(value)ä¸ºå…¶åˆ›å»ºç›‘å¬å™¨ä½¿valueå“åº”åŒ–



#### Observer

```js
var Observer = function Observer (value) {
  this.value = value;
  this.dep = new Dep();  //Depæ¶ˆæ¯è®¢é˜…å™¨
  this.vmCount = 0;
  //æ·»åŠ __ob__å±æ€§,Define a property.
  def(value, '__ob__', this);
  //åˆ¤æ–­å½“å‰çš„valueæ˜¯ä¸æ˜¯æ•°ç»„
  if (Array.isArray(value)) {
    if (hasProto) {
      //å¦‚æœæµè§ˆå™¨æœ‰æ•°ç»„çš„protoçš„è¯å°±ç”¨æµè§ˆå™¨çš„æ•°ç»„æ–¹æ³•å¹¶è¿›è¡Œå¢å¼º
      protoAugment(value, arrayMethods);
    } else {
      //å¤åˆ¶å¢å¼ºåçš„7ä¸ªæ•°ç»„æ–¹æ³•
      copyAugment(value, arrayMethods, arrayKeys);
    }
    //éå†æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œobserve
    this.observeArray(value);
  } else {
    this.walk(value);
  }
};
```

â€‹	ğŸŒŸè¿™é‡Œä¸»è¦æ˜¯è®²Observerç›‘å¬å™¨ä¼šå¯¹æ•°ç»„è¿›è¡Œç‰¹åˆ«çš„ç›‘å¬,

åªæœ‰æºç ä¸­çš„è¿™ä¸ƒä¸ªæ–¹æ³•ä¼šè¢«å“åº”å¼æ›´æ–°

```js
var methodsToPatch = [
  'push',
  'pop',
  'shift',
  'unshift',
  'splice',
  'sort',
  'reverse'
];
```



å¦‚æœæ˜¯æ•°ç»„çš„è¯ä¼šè°ƒç”¨å¯¹æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œéå†:

#### observeArray

```js
/**
* Observe a list of Array items.
*/
Observer.prototype.observeArray = function observeArray (items) {
   for (var i = 0, l = items.length; i < l; i++) {
      observe(items[i]);
   }
};
```

ğŸŒŸå¯¹æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨observeæ–¹æ³•è¿›è¡Œç›‘å¬, åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æœ‰:

```js
if (!isObject(value) || value instanceof VNode) {
    //å¦‚æœvalueä¸æ˜¯å¯¹è±¡æˆ–è€…valueä½¿VNodeçš„å®ä¾‹ç›´æ¥return
    return
}
```

ä¸æ˜¯å¯¹è±¡ç›´æ¥è¿”å›, æ˜¯å¯¹è±¡çš„è¯å°±ç»§ç»­åˆšæ‰çš„ä¸€ç³»åˆ—æ­¥éª¤ã€‚

â˜…this.walk(value)é‡‡ç”¨Object.definePropertyå¯¹æ‰€æœ‰çš„keyè¿›è¡Œè®¾ç½®äº†getterå’Œsetterï¼Œå°±æ˜¯åœ¨æ­¤æ—¶å®Œæˆäº†æ•°æ®åŠ«æŒï¼Œå¹¶æ·»åŠ ç›¸åº”çš„å‰¯ä½œç”¨ã€‚



#### â–¼Plus:

```html
<div id="app">
  <ul>
    <li v-for="item in objectList">
      {{item.value}}
    </li>
  </ul>
  <ul>
    <li v-for="item in list">
      {{item}}
    </li>
  </ul>
</div>
```

```js
const app = new Vue({
  el: '#app',
  data: {
    objectList: [
      { value: 1, id: 1 },
      { value: 2, id: 2 },
      { value: 3, id: 3 },
    ],
    list: ['4', '5', '6']
  },
  mounted () {
    this.list[1] = '6'
    this.objectList[1].value = 3
  }
})
```

è¿™æ—¶æ‰“å°çš„æ˜¯ ğŸ‘‡ , ä½†æ˜æ˜æ•°ç»„ä¸‹æ ‡ä¸ä¼šå“åº”å¼å˜åŒ–å•Š!!!ğŸ˜…

â€‹	![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](åŸºç¡€.assets/20200910154154848.png)

â–¼ç»§ç»­æ‰§è¡Œåé¢çš„this.objectList[1].value = 3æ—¶ï¼Œè¿™æ˜¯ä¸€ä¸ªå“åº”åŒ–çš„æ“ä½œï¼Œå› æ­¤å½“å€¼æ”¹å˜æ—¶ï¼Œä¼šè§¦å‘setterä¸­çš„**Dep.notify()**ï¼Œå»é€šçŸ¥è§†å›¾æ›´æ–°ï¼Œç»è¿‡ä¸€ç³»åˆ—vdomï¼Œpatchåï¼Œvueä¼šå‘ç°dataä¸­æœ‰ä¸ªlistæ•°ç»„ä¸­ä¸€ä¸ªå…ƒç´ å€¼ä¹Ÿæ”¹å˜äº†ï¼Œå› æ­¤ä¹Ÿä¼šå°†å½“å‰æ”¹å˜çš„å€¼å’Œlistæ•°ç»„ä¸­æ”¹å˜çš„é‚£ä¸ªå€¼éƒ½ç»™é‡æ–°æ¸²æŸ“äº†

```js
 Dep.prototype.notify = function notify () {
    // stabilize the subscriber list first
    var subs = this.subs.slice();
    if (!config.async) {
      // subs aren't sorted in scheduler if not running async
      // we need to sort them now to make sure they fire in correct
      // order
      subs.sort(function (a, b) { return a.id - b.id; });
    }
    for (var i = 0, l = subs.length; i < l; i++) {
      subs[i].update();
    }
  };
```

  â˜…å¯ä»¥çœ‹è§Dep.notifyä¼šå¯¹æ¯ä¸€ä¸ªè®¢é˜…è€…Subscriberè¿›è¡Œæ›´æ–°!!!

å› æ­¤è¿™é‡Œçš„æ•°ç»„ä¸‹æ ‡æ”¹å˜å€¼çš„å“åº”åŒ–å…¶å®æ˜¯åä¸€å¥æ‰§è¡Œ **this.objectList[1].value = 3**ï¼Œè¿™ä¸€å¥é€šçŸ¥è§†å›¾æ›´æ–°æ—¶ï¼Œä¼šæ£€æµ‹åˆ°å‰ä¸€ä¸ªlistæ•°ç»„ä¸­å€¼æœ‰å˜åŒ–ï¼Œä½†æ˜¯è§†å›¾ä¸­æ²¡æ›´æ–°ï¼Œå› æ­¤æ‰ä¼šä¸€èµ·æ¸²æŸ“



#### â–¼plus+ : å¦‚ä½•å®ç°å¯¹æ•°ç»„ä¸‹æ ‡çš„å“åº”å¼æ›´æ–°?

å‰é¢æˆ‘ä»¬ä¹ŸçŸ¥é“ï¼Œé€šè¿‡æ•°ç»„ä¸‹æ ‡æ”¹å˜å€¼ï¼Œèƒ½æˆåŠŸæ”¹å˜dataä¸­çš„å€¼ï¼Œä½†æ˜¯å› ä¸ºæ²¡æœ‰ç›‘å¬ï¼Œå› æ­¤ä¸ä¼šè§¦å‘å“åº”å¼æ›´æ–°

é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ å±æ€§ç›‘å¬å®Œæˆè¿™ä¸€æ“ä½œï¼Œä¼—æ‰€å‘¨çŸ¥ï¼Œæ•°ç»„ç´¢å¼•ä¹Ÿæ˜¯æ•°ç»„çš„ä¸€ä¸ªå±æ€§ï¼Œå› æ­¤è®©æˆ‘ä»¬é‡å†™ä¸€ä¸‹å¯¹æ•°ç»„çš„æ“ä½œ

```js
constructor (value: any) {
  this.value = value
  this.dep = new Dep()
  this.vmCount = 0
  def(value, '__ob__', this)
  if (Array.isArray(value)) {
    if (hasProto) {
      protoAugment(value, arrayMethods)
    } else {
      copyAugment(value, arrayMethods, arrayKeys)
    }
    // this.observeArray(value)
    this.walkArray(value)
  } else {
    this.walk(value)
  }
}
walkArray (obj: Object) {
  obj.forEach((item, index) => {
    defineReactive(obj, index)
  })
}

```

æˆ‘æŠŠåŸæœ¬çš„observeArrayæ³¨é‡Šäº†ï¼Œæ¢æˆäº†è‡ªå·±å†™çš„walkArrayï¼Œè€ŒwalkArrayå°±æ˜¯å®ç°äº†å¯¹ç´¢å¼•çš„ç›‘å¬ã€‚

è¿™æ—¶å€™å°±å·²ç»å®ç°æˆåŠŸäº†ï¼Œçœ‹çœ‹æ•ˆæœ

```html
<div id="app">
  <ul>
    <li v-for="item in list">
      {{item}}
    </li>
  </ul>
</div>
```

```js
const app = new Vue({
  el: "#app",
  data: {
    list: ['1', '2', '3']
  },
  mounted (){
    this.list[1] = 4
  }
})
```



ä¸ºä»€ä¹ˆvueæ²¡æœ‰æä¾›å¯¹æ•°ç»„å±æ€§çš„ç›‘å¬ï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](åŸºç¡€.assets/20200910155807708.png)





